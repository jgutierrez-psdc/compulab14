<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="sale_comercial.note_report_document">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.client_id.lang})"/>
            <div class="page" style="page-break-before: always;">
                <br/><br/><br/><br/><br/><br/><br/>
                <br/><br/><br/><br/><br/><br/><br/>
                <br/><br/><br/><br/><br/><br/><br/>
                <div style="width: 100%; top: 400px; text-align: center;">
                    <h1>PROPUESTA COMERCIAL</h1>
                    <h2>
                        <span t-raw="doc.name"/>
                    </h2>
                </div>
            </div>
            <div class="page" style="page-break-before: always;">
                <div class="oe_structure"/>
                  <div class="col-12">
                    <h2>Propuesta Comercial</h2>
                    <br></br>
                    <h4>Cliente: <span t-raw="doc.client_id.name"/></h4><br></br>
                    <p style="text-align: justify; font-size: 14px;">
                        <strong>Acuerdo de confidencialidad</strong><br/><br></br>
                        Por razones de índole comercial, puede resultar en perjuicio de Compulab, S.A., que las ideas,
                        conceptos, precios, aplicaciones, planes de entrega y en general las soluciones contenidas en este
                        informe sean conocidas por personas distintas a aquellas a quienes está dirigida.
                        <br/><br></br>
                        Toda la información contenida en la presente propuesta es propiedad de Compulab, S.A. y de
                        <span t-raw="doc.client_id.name"/>.
                        <br/><br></br>
                        La información contenida en este documento es confidencial y no debe ser revelada a ninguna
                        persona fuera de Compulab, S.A. y <span t-raw="doc.client_id.name"/>. sin autorización previa. Ninguna parte de esta
                        publicación debe ser reproducida, transmitida, copiada, almacenada o traducida a ningún lenguaje,
                        en ningún tipo de medio electrónico, mecánico, magnético, óptico, manual o de otra forma sin la
                        debida autorización escrita de Compulab, S.A. y <span t-raw="doc.client_id.name"/>
                        <br/><br></br>
                        Ninguna parte de esta publicación debe ser revelada, duplicado, usado o publicado total o
                        parcialmente, fuera de su organización sin la autorización escrita de Compulab S.A. y <span t-raw="doc.client_id.name"/>
                        <br/><br></br>
                        A su vez, <span t-raw="doc.client_id.name"/> se compromete a regirse conforme a las leyes panameñas relativas a la
                        protección de autoría intelectual y confidencialidad de la información.
                    </p>
                  </div>
                <div class="oe_structure"/>
            </div>
            <div class="page" style="page-break-before: always;">
                <div class="oe_structure"/>
                  <div class="col-12">
                      <h2>1. Introducción</h2>
                      <br></br>
                      <p style="text-align: justify; font-size: 14px;">
                          <span t-raw="doc.body"/>
                      </p>
                  </div>
                <div class="oe_structure"/>
            </div>
            <div class="page" style="page-break-before: always;">
                <div class="oe_structure"/>
                  <div class="col-12">
                    <h2>2. Perfil operativo</h2>
                    <br></br>
                    <p style="text-align: justify; font-size: 14px;">
                    <strong>Breve Historia</strong><br/><br></br>
                    </p>
                    <span t-raw="doc.body_bh"/><br></br>
                  </div>
                <div class="oe_structure"/>
            </div>
            <div class="page" style="page-break-before: always;">
                <div class="oe_structure"/>
                  <div class="col-12">
                    <h2>3. Descripción de los servicios a ser entregados</h2><br></br>
                    <p style="text-align: justify; font-size: 14px;">
                    <strong>a. Ubicación del Cliente</strong><br></br>
                    <span t-raw="doc.client_id.name"/>, <span t-raw="doc.client_id.street"/>.<br></br>
                    <strong>b. Contacto del Cliente</strong><br></br>
                    <span t-raw="doc.contact"/> Correo electrónico: <span t-raw="doc.contact_mail"/><br></br>Teléfono: <span t-raw="doc.contact_tel"/><br></br>
                    <strong>c. Alcance del proyecto</strong><br></br>
                    <span t-raw="doc.body_ap"/><br></br>
                    <strong>d. Requerimientos del Cliente</strong><br></br>
                    <span t-raw="doc.body_rc"/><br></br>
                    <h2>4. Supuesto</h2><br></br>
                    <span t-raw="doc.body_su"/><br></br>
                    <h2>5. Alcances no contemplados</h2><br></br>
                    <span t-raw="doc.body_anc"/><br></br>
                    <h2>6. Transferencia de conocimientos</h2><br></br>
                    <span t-raw="doc.body_tc"/><br></br>
                    <h2>7. Soporte y garantía</h2><br></br>
                    <span t-raw="doc.body_sg"/><br></br>
                    <h2>8. Capacitación</h2><br></br>
                    <span t-raw="doc.body_cap"/><br></br>
                    </p>  
                  </div>
                <div class="oe_structure"/>
            </div>
            <div class="page" style="page-break-before: always;">
                <div class="oe_structure"/>
                  <div class="col-12">
                    <h2>9. Personal a cargo del proyecto</h2><br></br>
                    <p style="text-align: justify; font-size: 14px;">
                    <strong>Ejecutivo de Cuenta: </strong><span t-raw="doc.user_id_ec.name"/>        <strong>Correo electrónico: </strong><span t-raw="doc.user_id_ec.login"/><br></br>
                    <strong>Preventa: </strong><span t-raw="doc.user_id.name"/>        <strong>Correo electrónico: </strong><span t-raw="doc.user_id.login"/><br></br>
                    <strong>Post Venta: </strong>
                        <t t-foreach="doc.user_id_pv" t-as="l">
                            <span t-raw="l.name"/>        <strong>Correo electrónico: </strong><span t-raw="l.login"/><br></br>
                        </t>
                    <h2>10. Propuesta Económica de Implementación</h2><br></br>
                    </p>
                    <t t-set="display_discount" t-value="any([l.discount for l in doc.sale_id.order_line])"/>
                    <t t-set="display_tax" t-value="any([l.tax_id for l in doc.sale_id.order_line])"/>

                    <table class="table table-sm o_main_table">
                        <thead>
                            <tr>
                                <th width="11%" class="text-center">Código</th>
                                <th width="40%" name="th_description" class="text-center">Descripción</th>
                                <th width="9%" name="th_quantity" class="text-right">Cantidad</th>
                                <th width="8%" name="th_priceunit" class="text-right">Precio U.</th>
                                <th name="th_discount" t-if="display_discount" class="text-right" groups="product.group_discount_per_so_line">
                                    <span>Disc.%</span>
                                </th>
                                <th width="8%" name="th_taxes" t-if="display_tax" class="text-center">ITBMS</th>
                                <th width="10%" name="th_subtotal" class="text-right">
                                    <t groups="account.group_show_line_subtotals_tax_excluded">Subtotal</t>
                                    <t groups="account.group_show_line_subtotals_tax_included">Total</t>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="sale_tbody">

                            <t t-set="current_subtotal" t-value="0"/>

                            <t t-foreach="doc.sale_id.order_line" t-as="line">

                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                                <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                    <t t-if="not line.display_type">
                                        <td class="text-center" width="10%">[<span style="font-size: 11px;" t-field="line.product_id.default_code"/>]</td>
                                        <td name="td_name">
                                            <span t-field="line.name"/>
                                        </td>
                                        <td name="td_quantity" class="text-right">
                                            <span t-field="line.product_uom_qty"/>
                                            <span t-field="line.product_uom" groups="uom.group_uom"/>
                                        </td>
                                        <td name="td_priceunit" class="text-right o_price_total">
                                            B/.<span t-field="line.price_unit"/>
                                        </td>
                                        <td t-if="display_discount" class="text-right" groups="product.group_discount_per_so_line">
                                            <span t-field="line.discount"/>
                                        </td>
                                        <td t-if="display_tax" name="td_taxes" width="5%" class="text-center">
                                            <span t-if="line.tax_id" t-esc="'✓'"/>
                                        </td>
                                        <td name="td_subtotal" class="text-right o_price_total">
                                            <span t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                            <span t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                        </td>
                                    </t>
                                    <t t-if="line.display_type == 'line_section'">
                                        <td name="td_section_line" colspan="99">
                                            <span t-field="line.name"/>
                                        </td>
                                        <t t-set="current_section" t-value="line"/>
                                        <t t-set="current_subtotal" t-value="0"/>
                                    </t>
                                    <t t-if="line.display_type == 'line_note'">
                                        <td name="td_note_line" colspan="99">
                                            <span t-field="line.name"/>
                                        </td>
                                    </t>
                                </tr>

                                <t t-if="current_section and (line_last or doc.sale_id.order_line[line_index+1].display_type == 'line_section')">
                                    <tr class="is-subtotal text-right">
                                        <td name="td_section_subtotal" colspan="99">
                                            <strong class="mr16">Subtotal</strong>
                                            <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.sale_id.pricelist_id.currency_id}"/>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                        </tbody>
                    </table>

                    <div class="clearfix" name="so_total_summary">
                        <div id="total" class="row" name="total">
                            <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                                <table class="table table-sm">
                                    <tr class="border-black o_subtotal" style="">
                                        <td name="td_amount_untaxed_label"><strong>Subtotal</strong></td>
                                        <td name="td_amount_untaxed" class="text-right">
                                            <span t-field="doc.sale_id.amount_untaxed"/>
                                        </td>
                                    </tr>
                                    <t t-foreach="doc.sale_id.amount_by_group" t-as="amount_by_group">
                                        <tr style="">
                                            <t t-if="amount_by_group[5] == 1 and doc.sale_id.amount_untaxed == amount_by_group[2]">
                                                <td name="td_amount_by_group_label_3">
                                                    <span t-esc="amount_by_group[0]"/>
                                                    <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.sale_id.pricelist_id.currency_id}"/></span>
                                                </td>
                                                <td name="td_amount_by_group_3" class="text-right o_price_total">
                                                    <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.sale_id.pricelist_id.currency_id}"/>
                                                </td>
                                            </t>
                                            <t t-else="">
                                                <td name="td_amount_by_group_label">
                                                    <span t-esc="amount_by_group[0]"/>
                                                </td>
                                                <td name="td_amount_by_group" class="text-right o_price_total">
                                                    <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.sale_id.pricelist_id.currency_id}"/>
                                                </td>
                                            </t>
                                        </tr>
                                    </t>
                                    <tr>
                                      <t t-if="doc.sale_id.amount_untaxed == doc.sale_id.amount_total">
                                        <td name="td_amount_by_group_label_3">ITBMS</td>
                                        <td name="td_amount_total" class="text-right">
                                            <span>B/.0.00</span>
                                        </td>
                                      </t>
                                    </tr>
                                    <tr class="border-black o_total">
                                        <td name="td_amount_total_label"><strong>Total</strong></td>
                                        <td name="td_amount_total" class="text-right">
                                            <span t-field="doc.sale_id.amount_total"/>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                    <span t-if="doc.sale_id.payment_term_id.note">
                      <strong>Condiciones Generales</strong><br></br>
                        <strong>Plazo de pago: </strong><span t-field="doc.sale_id.payment_term_id.note"/>
                    </span><br></br>
                    <span t-field="doc.sale_id.note"/>
                    <p id="fiscal_position_remark" t-if="doc.sale_id.fiscal_position_id and doc.sale_id.fiscal_position_id.sudo().note">
                        <strong>Observación de Posición Fiscal:</strong>
                        <span t-field="doc.sale_id.fiscal_position_id.sudo().note"/>
                    </p>
                  </div>
                  <br></br>
                  <strong>Fecha de la propuesta: <span t-field="doc.date"/></strong>
                <div class="oe_structure"/>
            </div>
            <t t-if="doc.body_anexo">
                <div class="page" style="page-break-before: always;">
                    <div class="oe_structure"/>
                    <div class="col-12">
                        <h2>11. Anexos</h2>
                        <br></br>
                        <p style="text-align: justify; font-size: 14px;">
                            <span t-raw="doc.body_anexo"/>
                        </p>
                    </div>
                    <div class="oe_structure"/>
                </div>
            </t>
        </t>
    </template>
    <template id="sale_comercial.note_report">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="sale_comercial.note_report_document" t-lang="doc.client_id.lang"/>
            </t>
        </t>
    </template>
</odoo>
